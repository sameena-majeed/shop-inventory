import*as e from"react";import n from"primereact/api";import{CSSTransition as t}from"primereact/csstransition";import{useEventListener as r,useMountEffect as o,useUpdateEffect as a,useOverlayListener as l,useUnmountEffect as i}from"primereact/hooks";import{OverlayService as u}from"primereact/overlayservice";import{Portal as c}from"primereact/portal";import{classNames as s,DomHandler as p,ObjectUtils as m,ZIndexUtils as f}from"primereact/utils";import{Ripple as d}from"primereact/ripple";function v(){return v=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},v.apply(this,arguments)}function h(e){if(Array.isArray(e))return e}function y(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,a=[],l=!0,i=!1;try{for(t=t.call(e);!(l=(r=t.next()).done)&&(a.push(r.value),!n||a.length!==n);l=!0);}catch(e){i=!0,o=e}finally{try{l||null==t.return||t.return()}finally{if(i)throw o}}return a}}function b(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function E(e,n){if(e){if("string"==typeof e)return b(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?b(e,n):void 0}}function g(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function w(e,n){return h(e)||y(e,n)||E(e,n)||g()}var N=e.memo((function(n){var t=w(e.useState(null),2),l=t[0],i=t[1],u=e.useRef(null),c=w(r({type:"click",listener:function(e){u.current&&!u.current.contains(e.target)&&i(null)}}),1)[0],f=function(){if(u.current){var e=u.current.parentElement,n=p.getOffset(e),t=p.getViewport(),r=u.current.offsetParent?u.current.offsetWidth:p.getHiddenElementOuterWidth(u.current),o=p.getOuterWidth(e.children[0]);parseInt(n.left,10)+o+r>t.width-p.calculateScrollbarWidth()&&p.addClass(u.current,"p-submenu-list-flipped")}},v=function(e,t){t.disabled?e.preventDefault():n.root?(l||n.popup)&&i(t):i(t)},h=function(e,t){t.disabled?e.preventDefault():(t.url||e.preventDefault(),t.command&&t.command({originalEvent:e,item:t}),n.root&&t.items&&i(l&&t===l?null:t),t.items||S())},y=function(e,t){var r=e.currentTarget.parentElement;switch(e.which){case 40:var o=E(r);o&&o.children[0].focus(),e.preventDefault();break;case 38:var a=g(r);a&&a.children[0].focus(),e.preventDefault();break;case 39:t.items&&(i(t),setTimeout((function(){r.children[1].children[0].children[0].focus()}),50)),e.preventDefault()}n.onKeyDown&&n.onKeyDown(e,r)},b=function(e,n){37===e.which&&(i(null),n.parentElement.previousElementSibling.focus())},E=function e(n){var t=n.nextElementSibling;return t?p.hasClass(t,"p-disabled")||!p.hasClass(t,"p-menuitem")?e(t):t:null},g=function e(n){var t=n.previousElementSibling;return t?p.hasClass(t,"p-disabled")||!p.hasClass(t,"p-menuitem")?e(t):t:null},S=function(){i(null),n.onLeafClick&&n.onLeafClick()};o((function(){c()})),a((function(){n.parentActive||i(null),!n.root&&n.parentActive&&f()}),[n.parentActive]);var x=function(n){return e.createElement("li",{key:"separator_"+n,className:"p-menu-separator",role:"separator"})},C=function(t){return t.items?e.createElement(N,{model:t.items,onLeafClick:S,popup:n.popup,onKeyDown:b,parentActive:t===l}):null},k=function(t,r){var o=t.style,a=t.disabled,i=t.icon,u=t.label,c=t.items,p=t.target,f=t.url,b=t.template,E=u+"_"+r,g=l===t,w=s("p-menuitem",{"p-menuitem-active":g},t.className),N=s("p-menuitem-link",{"p-disabled":a}),S=s("p-menuitem-icon",i),x="p-submenu-icon pi pi-angle-right",k=i&&e.createElement("span",{className:S}),D=u&&e.createElement("span",{className:"p-menuitem-text"},u),I=c&&e.createElement("span",{className:x}),T=C(t),O=e.createElement("a",{href:f||"#",className:N,target:p,role:"menuitem","aria-haspopup":null!=c,onClick:function(e){return h(e,t)},onKeyDown:function(e){return y(e,t)},"aria-disabled":a},k,D,I,e.createElement(d,null));b&&(O=m.getJSXElement(b,t,{onClick:function(e){return h(e,t)},onKeyDown:function(e){return y(e,t)},className:N,labelClassName:"p-menuitem-text",iconClassName:S,submenuIconClassName:x,element:O,props:n,active:g}));return e.createElement("li",{key:E,className:w,style:o,onMouseEnter:function(e){return v(e,t)},role:"none"},O,T)},D=function(e,n){return e.separator?x(n):k(e,n)},I=s({"p-submenu-list":!n.root}),T=n.model?n.model.map(D):null;return e.createElement("ul",{ref:u,className:I,role:n.root?"menubar":"menu","aria-orientation":"horizontal"},T)}));N.displayName="TieredMenuSub";var S=e.memo(e.forwardRef((function(r,o){var a=w(e.useState(!r.popup),2),d=a[0],h=a[1],y=e.useRef(null),b=e.useRef(null),E=w(l({target:b,overlay:y,listener:function(e,n){n.valid&&I(e)},when:d}),2),g=E[0],x=E[1],C=function(e){r.popup&&u.emit("overlay-click",{originalEvent:e,target:b.current})},k=function(e){r.popup&&(d?I(e):D(e))},D=function(e){b.current=e.currentTarget,h(!0),r.onShow&&r.onShow(e)},I=function(e){b.current=e.currentTarget,h(!1),r.onHide&&r.onHide(e)},T=function(){r.autoZIndex&&f.set("menu",y.current,n.autoZIndex,r.baseZIndex||n.zIndex.menu),p.absolutePosition(y.current,b.current)},O=function(){g()},A=function(){b.current=null,x()},K=function(){f.clear(y.current)};i((function(){f.clear(y.current)})),e.useImperativeHandle(o,(function(){return{toggle:k,show:D,hide:I}}));var P,j,H=(P=m.findDiffKeys(r,S.defaultProps),j=s("p-tieredmenu p-component",{"p-tieredmenu-overlay":r.popup},r.className),e.createElement(t,{nodeRef:y,classNames:"p-connected-overlay",in:d,timeout:{enter:120,exit:100},options:r.transitionOptions,unmountOnExit:!0,onEnter:T,onEntered:O,onExit:A,onExited:K},e.createElement("div",v({ref:y,id:r.id,className:j,style:r.style},P,{onClick:C}),e.createElement(N,{model:r.model,root:!0,popup:r.popup}))));return r.popup?e.createElement(c,{element:H,appendTo:r.appendTo}):H})));S.displayName="TieredMenu",S.defaultProps={__TYPE:"TieredMenu",id:null,model:null,popup:!1,style:null,className:null,autoZIndex:!0,baseZIndex:0,appendTo:null,transitionOptions:null,onShow:null,onHide:null};export{S as TieredMenu};
